<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · NoiseRobustDifferentiation.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">NoiseRobustDifferentiation.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Differences-to-MATLAB-Code"><span>Differences to MATLAB Code</span></a></li><li><a class="tocitem" href="#Citation"><span>Citation</span></a></li></ul></li><li><a class="tocitem" href="examples/">Examples</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/adrhill/NoiseRobustDifferentiation.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="NoiseRobustDifferentiation.jl"><a class="docs-heading-anchor" href="#NoiseRobustDifferentiation.jl">NoiseRobustDifferentiation.jl</a><a id="NoiseRobustDifferentiation.jl-1"></a><a class="docs-heading-anchor-permalink" href="#NoiseRobustDifferentiation.jl" title="Permalink"></a></h1><p>Julia reimplementation of <em>Total Variation Regularized Numerical Differentiation</em> (TVDiff).</p><p>Based on <a href="https://sites.google.com/site/dnartrahckcir/home/tvdiff-code">Rick Chartrand&#39;s original Matlab code</a> and <a href="https://github.com/stur86/tvregdiff">Simone Sturniolo&#39;s Python reimplementation</a>.</p><ul><li><a href="#NoiseRobustDifferentiation.jl">NoiseRobustDifferentiation.jl</a></li><ul><li><a href="#Installation">Installation</a></li><li><a href="#Functions">Functions</a></li><li><a href="#Differences-to-MATLAB-Code">Differences to MATLAB Code</a></li><li><a href="#Citation">Citation</a></li></ul><li><a href="examples/#Examples">Examples</a></li><ul><li><a href="examples/#Simple-example">Simple example</a></li><li><a href="examples/#Examples-from-paper">Examples from paper</a></li></ul></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>To install this package and its dependencies, open the Julia REPL and run </p><pre><code class="language-julia">julia&gt; ]add NoiseRobustDifferentiation</code></pre><p>Julia 1.5 is required.</p><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NoiseRobustDifferentiation.tvdiff" href="#NoiseRobustDifferentiation.tvdiff"><code>NoiseRobustDifferentiation.tvdiff</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">tvdiff(data::AbstractVector, iter::Integer, α::Real; kwargs...)</code></pre><p><strong>Arguments</strong></p><ul><li><p><code>data::AbstractVector</code>: Vector of data to be differentiated.</p></li><li><p><code>iter::Integer</code>: Number of iterations to run the main loop.  A stopping condition based on the norm of the gradient vector <code>g</code> below would be an easy modification.</p></li><li><p><code>α::Real</code>: Regularization parameter.  This is the main parameter to fiddle with.  Start by varying by orders of magnitude until reasonable results are obtained.  A value to the nearest power of 10 is usally adequate. Higher values increase regularization strenght and improve conditioning.</p></li></ul><p><strong>Keywords</strong></p><ul><li><p><code>u_0::AbstractVector</code>: Initialization of the iteration.  Default value is the naive derivative (without scaling), of appropriate length (this being different for the two methods). Although the solution is theoretically independent of the intialization, a poor choice can exacerbate conditioning issues when the linear system is solved.</p></li><li><p><code>scale::String</code>: Scale of dataset, <code>&quot;large&quot;</code> or <code>&quot;small&quot;</code> (case insensitive). Default is <code>&quot;small&quot;</code> .  <code>&quot;small&quot;</code>  has somewhat better boundary behavior, but becomes unwieldly for very large datasets. <code>&quot;large&quot;</code> has simpler numerics but is more efficient for large-scale problems.  <code>&quot;large&quot;</code> is more readily modified for higher-order derivatives, since the implicit differentiation matrix is square.</p></li><li><p><code>ε::Real</code>: Parameter for avoiding division by zero.  Default value is <code>1e-6</code>.  Results should not be very sensitive to the value.  Larger values improve conditioning and therefore speed, while smaller values give more accurate results with sharper jumps.</p></li><li><p><code>dx::Real</code>: Grid spacing, used in the definition of the derivative operators.  Default is <code>1 / length(data)</code>.</p></li><li><p><code>precond::String</code>: Select the preconditioner for the conjugate gradient method. Default is <code>&quot;none&quot;</code>.</p><ul><li><code>scale = &quot;small&quot;</code>: While in principle <code>precond=&quot;simple&quot;</code> should speed things up, sometimes the preconditioner can cause convergence problems instead, and should be left to <code>&quot;none&quot;</code>.</li><li><code>scale = &quot;large&quot;</code>: The improved preconditioners are one of the main features of the algorithm, therefore using the default <code>&quot;none&quot;</code> is discouraged. Currently, <code>&quot;diagonal&quot;</code>,<code>&quot;amg_rs&quot;</code>,<code>&quot;amg_sa&quot;</code> are available.</li></ul></li><li><p><code>diff_kernel::String</code>: Kernel to use in the integral to smooth the derivative. By default it is set to <code>&quot;abs&quot;</code>, the absolute value <span>$|u&#39;|$</span>. However, it can be changed to <code>&quot;square&quot;</code>, the square value <span>$(u&#39;)^2$</span>. The latter produces smoother derivatives, whereas the absolute values tends to make them more blocky.</p></li><li><p><code>cg_tol::Real</code>: Relative tolerance used in conjugate gradient method. Default is <code>1e-6</code>.</p></li><li><p><code>cgmaxit::Int</code>: Maximum number of iterations to use in conjugate gradient optimisation. Default is <code>100</code>.</p></li><li><p><code>show_diagn::Bool</code>: Flag whether to display diagnostics at each iteration. Default is <code>false</code>. Useful for diagnosing preconditioning problems. When tolerance is not met, an early iterate being best is more worrying than a large relative residual.</p></li></ul><p><strong>Output</strong></p><ul><li><code>u</code>: Estimate of the regularized derivative of data with <code>length(u) = length(data)</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adrhill/NoiseRobustDifferentiation.jl/blob/af40d76581dc539e14e1c0f62623f65d5ebce17c/src/tvdiff.jl#L1-L80">source</a></section></article><h2 id="Differences-to-MATLAB-Code"><a class="docs-heading-anchor" href="#Differences-to-MATLAB-Code">Differences to MATLAB Code</a><a id="Differences-to-MATLAB-Code-1"></a><a class="docs-heading-anchor-permalink" href="#Differences-to-MATLAB-Code" title="Permalink"></a></h2><h3 id="Conjugate-gradient-method"><a class="docs-heading-anchor" href="#Conjugate-gradient-method">Conjugate gradient method</a><a id="Conjugate-gradient-method-1"></a><a class="docs-heading-anchor-permalink" href="#Conjugate-gradient-method" title="Permalink"></a></h3><p>The <a href="https://sites.google.com/site/dnartrahckcir/home/tvdiff-code">original code</a> uses MATLAB&#39;s inbuilt function <code>pcg()</code>, which implements the preconditioned conjugate gradients method (PCG). This code uses the conjugate gradients method (CG) from <a href="https://github.com/JuliaMath/IterativeSolvers.jl">IterativeSolvers.jl</a>.  Refer to the <a href="https://juliamath.github.io/IterativeSolvers.jl/dev/linear_systems/cg/#Implementation-details-1">implementation details</a> for a brief discussion of differences between both methods.</p><p>Since the CG method from IterativeSolvers.jl allows for preconditioners, most of the options from <a href="https://github.com/mohamed82008/Preconditioners.jl">Preconditioners.jl</a> are implemented using default parameters.</p><h3 id="New-parameters"><a class="docs-heading-anchor" href="#New-parameters">New parameters</a><a id="New-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#New-parameters" title="Permalink"></a></h3><ul><li><code>precond</code>: Method used for preconditioning.</li><li><code>cg_tol</code>: Tolerance used in conjugate gradient method.</li></ul><h3 id="Other-differences"><a class="docs-heading-anchor" href="#Other-differences">Other differences</a><a id="Other-differences-1"></a><a class="docs-heading-anchor-permalink" href="#Other-differences" title="Permalink"></a></h3><ul><li><code>diag_flag</code> has been renamed to <code>show_diagn</code></li><li>removed plotting flag</li></ul><h2 id="Citation"><a class="docs-heading-anchor" href="#Citation">Citation</a><a id="Citation-1"></a><a class="docs-heading-anchor-permalink" href="#Citation" title="Permalink"></a></h2><p>Please cite the following paper if you use this code in published work:</p><blockquote><p>Rick Chartrand, &quot;Numerical differentiation of noisy, nonsmooth data,&quot; ISRN Applied Mathematics, Vol. 2011, Article ID 164564, 2011. </p></blockquote></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 10 December 2021 21:52">Friday 10 December 2021</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
